name: Spell Check

on:
  workflow_call:
    inputs:
      locale:
        description: 'Language locale for spell checking'
        required: false
        type: string
        default: 'en'
      extend-identifiers:
        description: 'Lines of identifier = "string" pairs for typos extend-identifiers section'
        required: false
        type: string
        default: ''
      config-path:
        description: 'Path to custom typos config file (if not provided, generates default)'
        required: false
        type: string
        default: ''

jobs:
  typos-check:
    name: Spell Check with Typos
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Actions Repository
        uses: actions/checkout@v5
      - name: Create typos config
        if: inputs.config-path == ''
        run: |
          cat > _typos.toml << EOF
          [default]
          locale = "${{ inputs.locale }}"

          [default.extend-identifiers]
          ${{ inputs.extend-identifiers }}
          
          [files]
          extend-exclude = [
            "*.json",
            "*.toml",
            "*.svg",
          ]
          EOF
          cat _typos.toml
      - name: Check spelling
        uses: crate-ci/typos@v1.39.2
        with:
          config: ${{ inputs.config-path != '' && inputs.config-path || '_typos.toml' }}
